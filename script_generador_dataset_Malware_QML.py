import random

# Leer todas las lÃ­neas del archivo
def cargar_datos(ruta):
    with open(ruta, "r") as fichero:
        lineas = fichero.readlines()
    return lineas[0], lineas[1:]  # Retornar cabecera y datos

# Cargar datos desde el dataset
cabecera, datos = cargar_datos("Obfuscated-MalMem2022.csv")

# Filtrar registros por clase
registros_malware = [linea for linea in datos if "Malware" in linea]
registros_benign = [linea for linea in datos if "Benign" in linea]

# Seleccionar 50 registros aleatorios de cada clase
muestra_malware = random.sample(registros_malware, 50) if len(registros_malware) >= 50 else registros_malware
muestra_benign = random.sample(registros_benign, 50) if len(registros_benign) >= 50 else registros_benign

# Unir y mezclar las muestras
muestra_final = muestra_malware + muestra_benign
random.shuffle(muestra_final)

# Guardar el nuevo dataset
with open("balanced_dataset_100_malware.csv", "w") as fichero_salida:
    fichero_salida.write(cabecera)
    fichero_salida.writelines(muestra_final)

print("Archivo 'balanced_dataset_100.csv' generado con 50 registros 'malware' y 50 registros 'benign'.")
